<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Tic Tac Toe</title>
    <style>
      body {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        height: 100vh;
      }

      .cell {
        font-family: sans-serif;
        font-size: larger;
        font-weight: bolder;
        background-color: beige;
        width: 100px;
        height: 100px;
        border: 1px solid black;
        text-align: center;
        display: flex;
        justify-content: center;
        align-items: center;
      }

      .cell:hover {
        background-color: blanchedalmond;
      }

      .row {
        display: flex;
      }
    </style>
  </head>

  <body>
    <h1 id="turn">Now it's <span>X</span>'s turn</h1>
    <div class="board">
      <div class="row">
        <div class="cell"></div>
        <div class="cell"></div>
        <div class="cell"></div>
      </div>
      <div class="row">
        <div class="cell"></div>
        <div class="cell"></div>
        <div class="cell"></div>
      </div>
      <div class="row">
        <div class="cell"></div>
        <div class="cell"></div>
        <div class="cell"></div>
      </div>
    </div>
    <button onclick="resetGame()">Reset</button>
    <script>
      let turn = "X";
      let gameEnded = false;
      let board = Array.from(document.getElementsByClassName("cell"));
      let turnLetter = document.querySelector("#turn span");
      let gameOverMessage = document.querySelector("#turn");

      let playerOWins = 0;
      let playerXWins = 0;

      const winningCombinations = [
        [0, 1, 2],
        [3, 4, 5],
        [6, 7, 8], // Rows
        [0, 3, 6],
        [1, 4, 7],
        [2, 5, 8], // Columns
        [0, 4, 8],
        [2, 4, 6], // Diagonals
      ];

      board.forEach((cell) => cell.addEventListener("click", cellClicked));

      function cellClicked(event) {
        if (gameEnded) return;

        let cell = event.target;
        if (cell.innerText !== "") return;

        cell.innerText = turn;
        cell.style.backgroundColor = turn === "X" ? "lightblue" : "lightpink";

        if (checkWin(turn)) {
          gameOver(turn);
          return;
        }

        if (checkDraw()) {
          gameOver("Draw");
          return;
        }

        turn = turn === "X" ? "O" : "X";
        turnLetter.innerText = turn;
      }

      function checkWin(player) {
        return winningCombinations.some((combination) => {
          return combination.every(
            (index) => board[index].innerText === player
          );
        });
      }

      function checkDraw() {
        return board.every((cell) => cell.innerText !== "");
      }

      function gameOver(result) {
        gameEnded = true;
        if (result === "Draw") {
          gameOverMessage.innerText = "It's a Draw!";
        } else {
          gameOverMessage.innerText = "Player " + result + " wins!";
          if (result === "X") {
            playerXWins++;
          } else {
            playerOWins++;
          }
          updateScore();
          strikeWinningCells(result);
        }
      }

      function updateScore() {
        const scoreElement = document.createElement("div");
        scoreElement.innerHTML = `Player X: ${playerXWins} - Player O: ${playerOWins}`;
        document.body.insertBefore(scoreElement, gameOverMessage.nextSibling);
      }

      function strikeWinningCells(player) {
        const winningCombination = winningCombinations.find((combination) => {
          return combination.every(
            (index) => board[index].innerText === player
          );
        });

        winningCombination.forEach((index) => {
          board[index].style.textDecoration = "line-through";
        });
      }

      function resetGame() {
        turn = "X";
        gameEnded = false;
        board.forEach((cell) => {
          cell.innerText = "";
          cell.style.backgroundColor = "beige";
          cell.style.textDecoration = "none";
        });
        gameOverMessage.innerText = "Now it's X's turn";
      }
    </script>
  </body>
</html>
